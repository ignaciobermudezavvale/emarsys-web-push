<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>EmarsysWebPush</title>
  <base href="/">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="icon" type="image/x-icon" href="favicon.ico">
  <script type="text/javascript" src="https://client-version.cf.emarsys.net/web-emarsys-sdk-v4/latest/web-emarsys-sdk.js" async></script>
  <script>
    localStorage.setItem('emarsys:debug', 'true');
  </script>
  <script type="text/javascript">
    window.WebEmarsysSdk = WebEmarsysSdk || []
    WebEmarsysSdk.push(['init', {
      applicationCode: 'EMSDE-283A2', // your Domain code obtained above
      enableMacSafariVapid: false, // If true, enables VAPID instead of APNS for Safari on Mac
      defaultNotificationTitle: 'Web push Piero', // sets your default title for push notifications
      defaultNotificationIcon: 'https://yoursite.com/img/your-logo.png', // URL to your notification icon
      autoSubscribe: true, // If true, prompts a user to subscribe for pushes upon SDK initialization which is not recommended
      serviceWorker: {
        url: 'web-emarsys-service-worker.js',
        applicationServerPublicKey: 'BIHgJ07cJBGpQplKGGd-CdJWgNYwBqvWNg65fiPXpIUn9fZuNZ121tUMdmwpBkzPYtu9i17JmFD_eboYiS3KcSU'
      }
    }])
    console.log('WebEmarsysSdk execute');
    WebEmarsysSdk.push(['onError', (e) => console.error('Emarsys SDK error:', e)]);
    WebEmarsysSdk.push(['onSubscribe', () => console.log('‚úÖ Usuario suscripto a Web Push')]);
  </script>
  <script>
    document.addEventListener('DOMContentLoaded', async () => {
      try {
        const permission = await Notification.requestPermission();
        console.log('üü¢ Permiso de notificaciones:', permission);
        if (permission === 'granted') {
          WebEmarsysSdk.push(['subscribe']);
        } else {
          console.warn('‚ö†Ô∏è El usuario no otorg√≥ permisos de notificaci√≥n.');
        }
      } catch (err) {
        console.error('‚ùå Error al pedir permiso de notificaciones:', err);
      }
    });
  </script>
  <script>
    function generalSubscribe() {
            return WebEmarsysSdk.subscribe()
    }
    // The submit event fires when a <form> is submitted.
    document.addEventListener('submit', function(e) {
            generalSubscribe();
    });
    // An element receives a click event when a pointing device button (such as a mouse's primary mouse button) is both pressed and released while the pointer is located inside the element.
    document.addEventListener('click', function(e) {
            generalSubscribe();
    });
  </script>
</head>
<body>
  <button onclick="generalSubscribe()">Subscribe</button>
  <app-root></app-root>
</body>
</html>
